2025-12-29 18:39:51,634 - app.services.search_service - WARNING - Recherche sémantique désactivée (sentence-transformers manquant)
2025-12-29 18:39:54,958 - app.main - INFO - ======================================================================
2025-12-29 18:39:55,431 - app.main - INFO - ======================================================================
2025-12-29 18:39:55,547 - app.main - INFO - ======================================================================
2025-12-29 19:02:08,341 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-29 19:02:09,151 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-29 19:02:09,371 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-29 19:02:09,374 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-12-29 19:02:15,457 - app.main - INFO - ======================================================================
2025-12-29 19:02:15,896 - app.main - INFO - ======================================================================
2025-12-29 19:02:15,966 - app.main - INFO - ======================================================================
2025-12-29 19:02:58,673 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/health "HTTP/1.1 500 "
2025-12-29 19:02:58,766 - app.main - INFO - POST /api/etl/upload-and-import - 200 - 1624.04ms
2025-12-29 19:03:11,953 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/health "HTTP/1.1 500 "
2025-12-29 19:03:11,960 - app.main - INFO - GET /api/health - 200 - 105.38ms
2025-12-29 19:05:31,457 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-29 19:05:31,583 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-29 19:05:34,327 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-29 19:05:34,336 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-12-29 19:05:40,488 - app.main - INFO - ======================================================================
2025-12-29 19:05:40,615 - app.main - INFO - ======================================================================
2025-12-29 19:05:42,103 - app.main - INFO - ======================================================================
2025-12-29 19:06:11,293 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-29 19:06:11,387 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-29 19:06:11,465 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-29 19:06:11,465 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-12-29 19:06:15,179 - app.main - INFO - ======================================================================
2025-12-29 19:06:15,252 - app.main - INFO - ======================================================================
2025-12-29 19:06:15,486 - app.main - INFO - ======================================================================
2025-12-29 19:06:45,215 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:06:45,301 - app.main - INFO - POST /api/etl/upload-and-import - 200 - 1987.24ms
2025-12-29 19:07:05,603 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:07:05,752 - app.main - INFO - POST /api/etl/upload-and-import - 200 - 741.41ms
2025-12-29 19:07:12,831 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:07:12,839 - app.main - INFO - GET /api/health - 200 - 30.86ms
2025-12-29 19:07:16,308 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:07:16,311 - app.main - INFO - GET /api/health - 200 - 18.39ms
2025-12-29 19:23:21,541 - app.services.search_service - WARNING - Recherche sémantique désactivée (sentence-transformers manquant)
2025-12-29 19:24:19,122 - app.main - INFO - ======================================================================
2025-12-29 19:24:19,186 - app.main - INFO - ======================================================================
2025-12-29 19:24:19,528 - app.main - INFO - ======================================================================
2025-12-29 19:43:41,014 - app.services.search_service - WARNING - Recherche sémantique désactivée (sentence-transformers manquant)
2025-12-29 19:43:45,949 - app.main - INFO - ======================================================================
2025-12-29 19:43:46,099 - app.main - INFO - ======================================================================
2025-12-29 19:43:46,204 - app.main - INFO - ======================================================================
2025-12-29 19:45:02,092 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:45:02,157 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/categories "HTTP/1.1 500 "
2025-12-29 19:45:02,222 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/health "HTTP/1.1 500 "
2025-12-29 19:45:02,239 - app.main - INFO - GET /api/health - 200 - 2677.58ms
2025-12-29 19:48:30,958 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:48:31,074 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/categories "HTTP/1.1 500 "
2025-12-29 19:48:31,147 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/health "HTTP/1.1 500 "
2025-12-29 19:48:31,174 - app.main - INFO - GET /api/health - 200 - 1006.04ms
2025-12-29 19:51:35,736 - app.main - INFO - GET /api/test-java - 404 - 86.35ms
2025-12-29 19:51:50,392 - app.main - INFO - GET /api/test-java - 404 - 1.67ms
2025-12-29 19:54:56,048 - app.services.search_service - WARNING - Recherche sémantique désactivée (sentence-transformers manquant)
2025-12-29 19:55:00,884 - app.main - INFO - ======================================================================
2025-12-29 19:55:00,942 - app.main - INFO - ======================================================================
2025-12-29 19:55:01,258 - app.main - INFO - ======================================================================
2025-12-29 19:55:11,765 - app.services.search_service - WARNING - Recherche sémantique désactivée (sentence-transformers manquant)
2025-12-29 19:55:17,166 - app.main - INFO - ======================================================================
2025-12-29 19:55:17,198 - app.main - INFO - ======================================================================
2025-12-29 19:55:17,369 - app.main - INFO - ======================================================================
2025-12-29 19:56:03,721 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2025-12-29 19:56:03,817 - app.main - INFO - POST /api/etl/upload-and-import - 200 - 3534.40ms
2026-01-04 19:02:40,603 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 19:02:41,047 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 19:03:11,263 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 19:03:11,263 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 19:06:06,135 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 19:06:06,273 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 19:06:22,561 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 19:06:22,562 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 19:07:51,234 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 19:07:51,400 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 19:08:05,972 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 19:08:05,973 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 19:09:21,878 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 19:09:21,918 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 19:09:33,041 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 19:09:33,041 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 19:09:36,629 - fastapi - ERROR - Form data requires "python-multipart" to be installed. 
You can install "python-multipart" with: 

pip install python-multipart

2026-01-04 19:10:30,300 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 19:10:30,338 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 19:10:40,409 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 19:10:40,410 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 19:10:44,131 - app.main - INFO - ======================================================================
2026-01-04 19:10:44,435 - app.main - INFO - ======================================================================
2026-01-04 19:10:44,499 - app.main - INFO - ======================================================================
2026-01-04 19:41:12,384 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-04 19:41:12,399 - app.main - INFO - GET /api/health - 200 - 1086.33ms
2026-01-04 21:18:48,818 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 21:18:48,996 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 21:19:57,879 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 21:19:57,880 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 21:20:03,046 - app.main - INFO - ======================================================================
2026-01-04 21:20:03,405 - app.main - INFO - ======================================================================
2026-01-04 21:20:03,488 - app.main - INFO - ======================================================================
2026-01-04 22:04:22,572 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-04 22:04:22,590 - app.main - INFO - GET /api/health - 200 - 1261.42ms
2026-01-04 22:35:42,895 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 22:35:43,453 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 22:36:46,737 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 22:36:47,352 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 22:37:19,162 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 22:37:19,163 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:37:25,071 - app.main - INFO - ======================================================================
2026-01-04 22:37:25,650 - app.main - INFO - ======================================================================
2026-01-04 22:37:25,749 - app.main - INFO - ======================================================================
2026-01-04 22:37:25,794 - app.main - INFO - POST /api/etl/validate - 400 - 7.85ms
2026-01-04 22:37:25,795 - app.main - INFO - POST /api/etl/validate - 400 - 8.39ms
2026-01-04 22:37:53,363 - app.main - INFO - POST /api/etl/validate - 200 - 241.85ms
2026-01-04 22:38:09,820 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 22:38:09,821 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:38:13,811 - app.main - INFO - ======================================================================
2026-01-04 22:38:14,414 - app.main - INFO - ======================================================================
2026-01-04 22:38:14,615 - app.main - INFO - ======================================================================
2026-01-04 22:38:38,838 - app.main - INFO - GET /api/etl/jobs - 200 - 1.89ms
2026-01-04 22:38:46,287 - app.main - INFO - GET /api/etl/jobs - 200 - 0.92ms
2026-01-04 22:44:08,432 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-04 22:44:08,449 - app.main - INFO - GET /api/health - 200 - 1522.63ms
2026-01-04 22:44:17,526 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-04 22:44:17,531 - app.main - INFO - GET /api/health - 200 - 24.21ms
2026-01-04 22:45:18,809 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 22:45:18,911 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 22:45:41,520 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 22:45:41,521 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:48:35,240 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 22:48:35,385 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 22:49:03,247 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 22:49:03,248 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:49:09,821 - app.main - INFO - ======================================================================
2026-01-04 22:49:09,844 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-04 22:49:09,879 - app.main - INFO - ======================================================================
2026-01-04 22:49:09,882 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-04 22:49:09,916 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-04 22:49:09,925 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:49:09,944 - app.main - INFO - [LLM] Ollama: mistral
2026-01-04 22:49:09,950 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-04 22:49:09,959 - app.main - INFO - ======================================================================
2026-01-04 22:49:53,431 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-04 22:50:17,475 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 22:50:17,701 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 22:50:48,727 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 22:50:48,732 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:50:54,848 - app.main - INFO - ======================================================================
2026-01-04 22:50:54,852 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-04 22:50:54,864 - app.main - INFO - ======================================================================
2026-01-04 22:50:54,865 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-04 22:50:54,868 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-04 22:50:54,872 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:50:54,880 - app.main - INFO - [LLM] Ollama: mistral
2026-01-04 22:50:54,883 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-04 22:50:54,889 - app.main - INFO - ======================================================================
2026-01-04 22:51:02,217 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-04 22:51:28,173 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 22:51:28,267 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 22:51:53,260 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-04 22:51:53,261 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:51:57,281 - app.main - INFO - ======================================================================
2026-01-04 22:51:57,282 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-04 22:51:57,283 - app.main - INFO - ======================================================================
2026-01-04 22:51:57,284 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-04 22:51:57,284 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-04 22:51:57,285 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-04 22:51:57,286 - app.main - INFO - [LLM] Ollama: mistral
2026-01-04 22:51:57,288 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-04 22:51:57,290 - app.main - INFO - ======================================================================
2026-01-04 23:28:29,204 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de prix chargÃ©
2026-01-04 23:28:29,268 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de demande chargÃ©
2026-01-04 23:28:29,325 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le bestseller chargÃ©
2026-01-04 23:28:29,367 - app.services.ml_service_v2 - INFO - âœ… Scaler chargÃ©
2026-01-04 23:28:29,406 - app.services.ml_service_v2 - INFO - âœ… Label encoders chargÃ©s
2026-01-04 23:28:29,441 - app.services.ml_service_v2 - INFO - âœ… Feature columns chargÃ©es
2026-01-04 23:28:29,442 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML chargÃ©s depuis data\models
2026-01-04 23:28:29,499 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-04 23:28:30,441 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-04 23:28:30,568 - app.services.ml_service_v2 - INFO - âœ… Index FAISS chargÃ©
2026-01-04 23:28:30,608 - app.services.ml_service_v2 - INFO - âœ… 513 product IDs chargÃ©s
2026-01-04 23:28:30,648 - app.services.ml_service_v2 - INFO - âœ… Embeddings shape: (513, 256)
2026-01-04 23:28:30,774 - app.services.ml_service_v2 - INFO - âœ… 513 produits chargÃ©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:06:17,896 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de prix chargÃ©
2026-01-05 01:06:17,984 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de demande chargÃ©
2026-01-05 01:06:18,056 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le bestseller chargÃ©
2026-01-05 01:06:18,109 - app.services.ml_service_v2 - INFO - âœ… Scaler chargÃ©
2026-01-05 01:06:18,159 - app.services.ml_service_v2 - INFO - âœ… Label encoders chargÃ©s
2026-01-05 01:06:18,204 - app.services.ml_service_v2 - INFO - âœ… Feature columns chargÃ©es
2026-01-05 01:06:18,205 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML chargÃ©s depuis data\models
2026-01-05 01:06:18,252 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:06:18,907 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:06:18,981 - app.services.ml_service_v2 - INFO - âœ… Index FAISS chargÃ©
2026-01-05 01:06:19,012 - app.services.ml_service_v2 - INFO - âœ… 513 product IDs chargÃ©s
2026-01-05 01:06:19,054 - app.services.ml_service_v2 - INFO - âœ… Embeddings shape: (513, 256)
2026-01-05 01:06:19,169 - app.services.ml_service_v2 - INFO - âœ… 513 produits chargÃ©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:07:43,346 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:07:43,347 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:07:50,138 - app.main - INFO - ======================================================================
2026-01-05 01:07:50,138 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:07:50,139 - app.main - INFO - ======================================================================
2026-01-05 01:07:50,139 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:07:50,140 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:07:50,141 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:07:50,141 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:07:50,141 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:07:50,142 - app.main - INFO - ======================================================================
2026-01-05 01:10:13,341 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:10:13,350 - app.main - INFO - GET /api/health - 200 - 1123.70ms
2026-01-05 01:10:56,338 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de prix chargÃ©
2026-01-05 01:10:56,351 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de demande chargÃ©
2026-01-05 01:10:56,363 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le bestseller chargÃ©
2026-01-05 01:10:56,366 - app.services.ml_service_v2 - INFO - âœ… Scaler chargÃ©
2026-01-05 01:10:56,368 - app.services.ml_service_v2 - INFO - âœ… Label encoders chargÃ©s
2026-01-05 01:10:56,370 - app.services.ml_service_v2 - INFO - âœ… Feature columns chargÃ©es
2026-01-05 01:10:56,370 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML chargÃ©s depuis data\models
2026-01-05 01:10:56,373 - app.services.ml_service_v2 - INFO - âœ… Index FAISS chargÃ©
2026-01-05 01:10:56,375 - app.services.ml_service_v2 - INFO - âœ… 513 product IDs chargÃ©s
2026-01-05 01:10:56,378 - app.services.ml_service_v2 - INFO - âœ… Embeddings shape: (513, 256)
2026-01-05 01:10:56,403 - app.services.ml_service_v2 - INFO - âœ… 513 produits chargÃ©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:10:56,453 - app.services.ml_service_v2 - ERROR - Erreur prÃ©paration features: X has 4 features, but StandardScaler is expecting 3 features as input.
2026-01-05 01:10:56,457 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 143.61ms
2026-01-05 01:19:50,445 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:19:50,451 - app.main - INFO - GET /api/health - 200 - 51.66ms
2026-01-05 01:31:39,930 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 01:31:55,364 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de prix chargÃ©
2026-01-05 01:31:55,477 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de demande chargÃ©
2026-01-05 01:31:55,532 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le bestseller chargÃ©
2026-01-05 01:31:55,543 - app.services.ml_service_v2 - INFO - âœ… Scaler chargÃ©
2026-01-05 01:31:55,548 - app.services.ml_service_v2 - INFO - âœ… Label encoders chargÃ©s
2026-01-05 01:31:55,562 - app.services.ml_service_v2 - INFO - âœ… Feature columns chargÃ©es
2026-01-05 01:31:55,563 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML chargÃ©s depuis data\models
2026-01-05 01:31:55,642 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:31:56,046 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:31:56,362 - app.services.ml_service_v2 - INFO - âœ… Index FAISS chargÃ©
2026-01-05 01:31:56,396 - app.services.ml_service_v2 - INFO - âœ… 513 product IDs chargÃ©s
2026-01-05 01:31:56,454 - app.services.ml_service_v2 - INFO - âœ… Embeddings shape: (513, 256)
2026-01-05 01:31:56,688 - app.services.ml_service_v2 - INFO - âœ… 513 produits chargÃ©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:32:13,930 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:32:13,930 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:32:17,489 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 01:32:17,747 - app.main - INFO - ======================================================================
2026-01-05 01:32:17,747 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:32:17,748 - app.main - INFO - ======================================================================
2026-01-05 01:32:17,748 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:32:17,748 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:32:17,748 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:32:17,749 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:32:17,749 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:32:17,751 - app.main - INFO - ======================================================================
2026-01-05 01:32:24,647 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de prix chargÃ©
2026-01-05 01:32:24,670 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de demande chargÃ©
2026-01-05 01:32:24,688 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le bestseller chargÃ©
2026-01-05 01:32:24,690 - app.services.ml_service_v2 - INFO - âœ… Scaler chargÃ©
2026-01-05 01:32:24,691 - app.services.ml_service_v2 - INFO - âœ… Label encoders chargÃ©s
2026-01-05 01:32:24,692 - app.services.ml_service_v2 - INFO - âœ… Feature columns chargÃ©es
2026-01-05 01:32:24,693 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML chargÃ©s depuis data\models
2026-01-05 01:32:24,707 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:32:24,742 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:32:24,758 - app.services.ml_service_v2 - INFO - âœ… Index FAISS chargÃ©
2026-01-05 01:32:24,759 - app.services.ml_service_v2 - INFO - âœ… 513 product IDs chargÃ©s
2026-01-05 01:32:24,760 - app.services.ml_service_v2 - INFO - âœ… Embeddings shape: (513, 256)
2026-01-05 01:32:24,781 - app.services.ml_service_v2 - INFO - âœ… 513 produits chargÃ©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:32:24,917 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 01:32:36,644 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 01:32:36,645 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 01:32:36,646 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 01:32:36,659 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:32:36,660 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:32:40,599 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 01:32:40,940 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 01:32:41,259 - app.main - INFO - ======================================================================
2026-01-05 01:32:41,261 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:32:41,262 - app.main - INFO - ======================================================================
2026-01-05 01:32:41,263 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:32:41,266 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:32:41,273 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:32:41,274 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:32:41,275 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:32:41,276 - app.main - INFO - ======================================================================
2026-01-05 01:36:46,906 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 01:36:54,242 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de prix chargÃ©
2026-01-05 01:36:54,252 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le de demande chargÃ©
2026-01-05 01:36:54,263 - app.services.ml_service_v2 - INFO - âœ… ModÃ¨le bestseller chargÃ©
2026-01-05 01:36:54,264 - app.services.ml_service_v2 - INFO - âœ… Scaler chargÃ©
2026-01-05 01:36:54,265 - app.services.ml_service_v2 - INFO - âœ… Label encoders chargÃ©s
2026-01-05 01:36:54,266 - app.services.ml_service_v2 - INFO - âœ… Feature columns chargÃ©es
2026-01-05 01:36:54,267 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML chargÃ©s depuis data\models
2026-01-05 01:36:54,279 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:36:54,312 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:36:54,331 - app.services.ml_service_v2 - INFO - âœ… Index FAISS chargÃ©
2026-01-05 01:36:54,332 - app.services.ml_service_v2 - INFO - âœ… 513 product IDs chargÃ©s
2026-01-05 01:36:54,334 - app.services.ml_service_v2 - INFO - âœ… Embeddings shape: (513, 256)
2026-01-05 01:36:54,354 - app.services.ml_service_v2 - INFO - âœ… 513 produits chargÃ©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:36:54,482 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 01:37:06,966 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 01:37:06,966 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 01:37:06,967 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 01:37:06,971 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:37:06,972 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:37:10,550 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 01:37:10,779 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 01:37:10,966 - app.main - INFO - ======================================================================
2026-01-05 01:37:10,966 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:37:10,966 - app.main - INFO - ======================================================================
2026-01-05 01:37:10,966 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:37:10,967 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:37:10,967 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:37:10,968 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:37:10,968 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:37:10,969 - app.main - INFO - ======================================================================
2026-01-05 01:37:17,074 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:37:17,082 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:37:17,092 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:37:17,093 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:37:17,095 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:37:17,095 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:37:17,096 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:37:17,109 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:37:17,140 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:37:17,153 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:37:17,154 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:37:17,156 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:37:17,172 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:37:17,275 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 01:37:27,013 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 01:37:27,014 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 01:37:27,014 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 01:37:27,015 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:37:27,016 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:37:30,016 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 01:37:30,206 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 01:37:30,381 - app.main - INFO - ======================================================================
2026-01-05 01:37:30,381 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:37:30,381 - app.main - INFO - ======================================================================
2026-01-05 01:37:30,381 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:37:30,382 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:37:30,382 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:37:30,382 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:37:30,382 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:37:30,383 - app.main - INFO - ======================================================================
2026-01-05 01:40:32,985 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:40:32,994 - app.main - INFO - GET /api/health - 200 - 1092.85ms
2026-01-05 01:40:33,077 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:40:33,080 - app.main - INFO - GET /api/health - 200 - 19.43ms
2026-01-05 01:40:33,144 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:40:33,146 - app.main - INFO - GET /api/health - 200 - 19.90ms
2026-01-05 01:40:33,162 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:40:33,166 - app.main - INFO - GET /api/health - 200 - 14.88ms
2026-01-05 01:40:33,501 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:33,511 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:33,528 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:33,530 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:33,531 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:33,533 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:33,534 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:33,537 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:33,539 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:33,541 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:33,566 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:33,622 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:40:33,640 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:33,650 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:33,664 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:33,666 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:33,670 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:33,671 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:33,672 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:33,673 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:33,674 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:33,676 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:33,710 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:33,713 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:40:33,717 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:40:34,138 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:40:34,196 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:34,215 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:34,232 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:34,238 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:34,240 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:34,242 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:34,243 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:34,245 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:34,247 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:34,249 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:34,274 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:34,277 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:40:34,280 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 791.63ms
2026-01-05 01:40:34,299 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:34,312 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:34,325 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:34,327 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:34,329 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:34,330 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:34,330 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:34,332 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:34,333 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:34,335 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:34,359 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:34,492 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:34,509 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:34,527 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:34,529 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:34,531 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:34,532 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:34,533 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:34,534 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:34,537 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:34,538 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:34,561 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:34,664 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:34,676 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:34,689 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:34,690 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:34,692 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:34,693 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:34,693 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:34,695 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:34,696 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:34,697 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:34,725 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:34,727 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:40:34,729 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 1013.73ms
2026-01-05 01:40:34,731 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 1015.07ms
2026-01-05 01:40:34,732 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1016.21ms
2026-01-05 01:40:34,790 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:40:34,793 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 22.83ms
2026-01-05 01:40:34,813 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:40:34,815 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 16.18ms
2026-01-05 01:40:34,822 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.17ms
2026-01-05 01:40:34,864 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:40:34,867 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 21.64ms
2026-01-05 01:40:34,887 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:40:34,890 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 18.34ms
2026-01-05 01:40:34,895 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 0.96ms
2026-01-05 01:40:50,668 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:40:50,672 - app.main - INFO - GET /api/health - 200 - 17.92ms
2026-01-05 01:40:50,689 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:40:50,692 - app.main - INFO - GET /api/health - 200 - 15.77ms
2026-01-05 01:40:50,784 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:50,795 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:50,808 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:50,810 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:50,811 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:50,812 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:50,813 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:50,814 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:50,815 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:50,821 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:50,852 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:50,944 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 179.19ms
2026-01-05 01:40:50,972 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:50,990 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:51,006 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:51,008 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:51,010 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:51,011 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:51,012 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:51,013 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:51,014 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:51,016 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:51,047 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:51,053 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:40:51,056 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 112.62ms
2026-01-05 01:40:51,083 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:40:51,106 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:40:51,121 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:40:51,123 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:40:51,125 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:40:51,126 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:40:51,126 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:40:51,127 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:40:51,129 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:40:51,131 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:40:51,156 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:40:51,159 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:40:51,162 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:40:51,232 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:40:51,235 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 28.01ms
2026-01-05 01:40:51,249 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:40:51,254 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 13.84ms
2026-01-05 01:40:51,260 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.01ms
2026-01-05 01:41:00,775 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:41:00,779 - app.main - INFO - GET /api/health - 200 - 31.01ms
2026-01-05 01:41:00,807 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:41:00,816 - app.main - INFO - GET /api/health - 200 - 29.66ms
2026-01-05 01:41:00,913 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:41:00,927 - app.main - INFO - GET /api/health - 200 - 53.75ms
2026-01-05 01:41:00,960 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:41:00,962 - app.main - INFO - GET /api/health - 200 - 21.60ms
2026-01-05 01:41:01,034 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:01,060 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:01,075 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:01,078 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:01,080 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:01,082 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:01,082 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:01,084 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:01,089 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:01,091 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:01,116 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:01,121 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:41:01,123 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:41:01,229 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:01,256 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:01,276 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:01,278 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:01,281 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:01,282 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:01,282 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:01,285 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:01,288 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:01,289 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:01,316 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:01,322 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:41:01,325 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 324.69ms
2026-01-05 01:41:01,359 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:01,375 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:01,391 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:01,393 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:01,395 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:01,397 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:01,397 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:01,399 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:01,400 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:01,403 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:01,428 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:01,433 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:41:01,450 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:01,466 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:01,480 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:01,481 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:01,483 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:01,486 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:01,487 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:01,489 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:01,490 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:01,491 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:01,513 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:01,516 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:41:01,535 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:01,555 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:01,573 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:01,576 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:01,577 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:01,578 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:01,579 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:01,580 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:01,583 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:01,585 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:01,611 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:01,725 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:01,737 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:01,747 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:01,749 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:01,752 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:01,753 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:01,754 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:01,755 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:01,756 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:01,758 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:01,780 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:01,915 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 588.14ms
2026-01-05 01:41:01,917 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:41:01,955 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 627.32ms
2026-01-05 01:41:01,966 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 639.08ms
2026-01-05 01:41:02,033 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:41:02,037 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 21.76ms
2026-01-05 01:41:02,059 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:41:02,062 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 17.69ms
2026-01-05 01:41:02,067 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.16ms
2026-01-05 01:41:02,112 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:41:02,116 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 25.93ms
2026-01-05 01:41:02,142 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:41:02,146 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 21.19ms
2026-01-05 01:41:02,157 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 2.30ms
2026-01-05 01:41:25,441 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 01:41:36,004 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:41:36,012 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:41:36,026 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:41:36,027 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:41:36,029 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:41:36,030 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:41:36,030 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:41:36,063 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:41:36,118 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:41:36,141 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:41:36,142 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:41:36,144 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:41:36,172 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:41:36,290 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 01:41:55,473 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 01:41:55,473 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 01:41:55,474 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 01:41:55,477 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:41:55,477 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:41:59,320 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 01:41:59,637 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 01:41:59,913 - app.main - INFO - ======================================================================
2026-01-05 01:41:59,913 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:41:59,914 - app.main - INFO - ======================================================================
2026-01-05 01:41:59,914 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:41:59,915 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:41:59,915 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:41:59,916 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:41:59,916 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:41:59,916 - app.main - INFO - ======================================================================
2026-01-05 01:42:54,118 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:42:54,130 - app.main - INFO - GET /api/health - 200 - 1046.49ms
2026-01-05 01:42:54,167 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:42:54,174 - app.main - INFO - GET /api/health - 200 - 25.20ms
2026-01-05 01:42:54,222 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:42:54,231 - app.main - INFO - GET /api/health - 200 - 35.21ms
2026-01-05 01:42:54,270 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:42:54,275 - app.main - INFO - GET /api/health - 200 - 30.08ms
2026-01-05 01:42:54,379 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:42:54,395 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:42:54,423 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:42:54,429 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:42:54,433 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:42:54,442 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:42:54,445 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:42:54,447 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:42:54,451 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:42:54,457 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:42:54,482 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:42:54,495 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:42:54,524 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:42:54,539 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:42:54,551 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:42:54,556 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:42:54,558 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:42:54,559 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:42:54,560 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:42:54,561 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:42:54,563 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:42:54,565 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:42:54,588 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:42:54,590 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:42:54,594 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:42:54,639 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 318.46ms
2026-01-05 01:42:54,655 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:42:54,667 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:42:54,680 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:42:54,682 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:42:54,683 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:42:54,684 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:42:54,687 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:42:54,688 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:42:54,689 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:42:54,691 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:42:54,712 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:42:54,844 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 518.41ms
2026-01-05 01:42:54,874 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:42:54,892 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:42:54,908 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:42:54,910 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:42:54,912 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:42:54,913 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:42:54,913 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:42:54,915 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:42:54,916 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:42:54,917 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:42:54,942 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:42:54,944 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:42:54,960 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:42:54,971 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:42:54,983 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:42:54,988 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:42:54,990 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:42:54,991 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:42:54,991 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:42:54,992 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:42:54,994 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:42:54,995 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:42:55,023 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:42:55,198 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:42:55,225 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:42:55,253 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:42:55,259 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:42:55,265 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:42:55,271 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:42:55,275 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:42:55,278 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:42:55,282 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:42:55,291 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:42:55,325 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:42:55,327 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:42:55,330 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:42:55,360 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 512.47ms
2026-01-05 01:42:55,362 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 514.40ms
2026-01-05 01:42:55,391 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:42:55,393 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 29.75ms
2026-01-05 01:42:55,419 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:42:55,424 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 25.47ms
2026-01-05 01:42:55,431 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.70ms
2026-01-05 01:42:55,481 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:42:55,492 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 32.83ms
2026-01-05 01:42:55,525 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:42:55,532 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 31.93ms
2026-01-05 01:42:55,541 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.40ms
2026-01-05 01:43:26,330 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:43:26,332 - app.main - INFO - GET /api/health - 200 - 17.67ms
2026-01-05 01:43:26,347 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:43:26,350 - app.main - INFO - GET /api/health - 200 - 12.93ms
2026-01-05 01:43:26,373 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:43:26,376 - app.main - INFO - GET /api/health - 200 - 15.02ms
2026-01-05 01:43:26,399 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:43:26,403 - app.main - INFO - GET /api/health - 200 - 22.59ms
2026-01-05 01:43:26,426 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:43:26,445 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:43:26,457 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:43:26,459 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:43:26,461 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:43:26,462 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:43:26,462 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:43:26,464 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:43:26,465 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:43:26,469 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:43:26,505 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:43:26,508 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:43:26,524 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:43:26,534 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:43:26,554 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:43:26,556 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:43:26,558 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:43:26,560 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:43:26,560 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:43:26,562 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:43:26,564 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:43:26,566 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:43:26,592 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:43:26,739 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:43:26,749 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:43:26,762 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:43:26,764 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:43:26,766 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:43:26,767 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:43:26,769 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:43:26,771 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:43:26,772 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:43:26,775 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:43:26,803 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:43:26,806 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:43:26,811 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:43:26,834 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 425.87ms
2026-01-05 01:43:26,837 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 429.00ms
2026-01-05 01:43:26,868 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:43:26,885 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:43:26,899 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:43:26,900 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:43:26,905 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:43:26,906 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:43:26,907 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:43:26,908 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:43:26,910 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:43:26,911 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:43:26,936 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:43:26,939 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:43:26,942 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 102.51ms
2026-01-05 01:43:26,959 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:43:26,971 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:43:26,988 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:43:26,990 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:43:26,992 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:43:26,993 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:43:26,994 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:43:26,995 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:43:26,996 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:43:26,998 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:43:27,021 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:43:27,166 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:43:27,178 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:43:27,191 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:43:27,192 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:43:27,194 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:43:27,195 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:43:27,195 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:43:27,197 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:43:27,198 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:43:27,200 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:43:27,226 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:43:27,230 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:43:27,234 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 388.98ms
2026-01-05 01:43:27,241 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:43:27,282 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:43:27,285 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 341.30ms
2026-01-05 01:43:27,319 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:43:27,328 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 32.90ms
2026-01-05 01:43:27,335 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.29ms
2026-01-05 01:43:27,367 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:43:27,374 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 23.40ms
2026-01-05 01:43:27,395 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:43:27,397 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 15.84ms
2026-01-05 01:43:27,404 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.43ms
2026-01-05 01:44:47,434 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 01:45:09,402 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:09,416 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:09,437 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:09,440 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:09,445 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:09,447 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:09,448 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:09,476 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 01:45:09,586 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 01:45:09,611 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:09,612 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:09,618 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:09,655 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:09,817 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 01:45:28,638 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 01:45:28,639 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 01:45:28,639 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 01:45:28,642 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 01:45:28,643 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:45:33,025 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 01:45:33,464 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 01:45:33,779 - app.main - INFO - ======================================================================
2026-01-05 01:45:33,779 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 01:45:33,779 - app.main - INFO - ======================================================================
2026-01-05 01:45:33,780 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 01:45:33,780 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 01:45:33,780 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 01:45:33,781 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 01:45:33,781 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 01:45:33,781 - app.main - INFO - ======================================================================
2026-01-05 01:45:38,119 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:45:38,125 - app.main - INFO - GET /api/health - 200 - 742.69ms
2026-01-05 01:45:38,140 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:45:38,143 - app.main - INFO - GET /api/health - 200 - 14.09ms
2026-01-05 01:45:38,160 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:45:38,162 - app.main - INFO - GET /api/health - 200 - 13.91ms
2026-01-05 01:45:38,180 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:45:38,189 - app.main - INFO - GET /api/health - 200 - 23.47ms
2026-01-05 01:45:38,226 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:38,241 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:38,252 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:38,256 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:38,259 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:38,259 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:38,260 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:38,261 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:38,262 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:38,264 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:38,281 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:38,377 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 188.53ms
2026-01-05 01:45:38,391 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:38,400 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:38,412 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:38,413 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:38,414 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:38,415 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:38,416 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:38,417 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:38,418 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:38,420 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:38,439 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:38,441 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:45:38,450 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:38,460 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:38,468 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:38,471 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:38,473 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:38,474 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:38,475 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:38,476 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:38,477 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:38,478 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:38,494 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:38,497 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:45:38,500 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 306.78ms
2026-01-05 01:45:38,504 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:45:38,560 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:38,576 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:38,586 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:38,590 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:38,591 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:38,592 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:38,592 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:38,593 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:38,594 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:38,595 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:38,613 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:38,615 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:45:38,618 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 118.67ms
2026-01-05 01:45:38,634 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:38,644 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:38,654 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:38,657 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:38,659 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:38,660 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:38,660 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:38,661 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:38,662 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:38,663 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:38,681 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:38,684 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:45:38,696 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:45:38,706 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:45:38,714 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:45:38,716 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:45:38,717 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:45:38,720 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:45:38,721 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:45:38,723 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:45:38,724 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:45:38,726 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:45:38,742 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:45:38,815 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:45:38,829 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 289.22ms
2026-01-05 01:45:38,844 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:45:38,846 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 226.28ms
2026-01-05 01:45:38,869 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:45:38,875 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 24.86ms
2026-01-05 01:45:38,880 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 0.97ms
2026-01-05 01:45:38,901 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:45:38,907 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 14.84ms
2026-01-05 01:45:38,924 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:45:38,926 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 15.33ms
2026-01-05 01:45:38,930 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 0.67ms
2026-01-05 01:46:03,528 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:46:03,531 - app.main - INFO - GET /api/health - 200 - 17.19ms
2026-01-05 01:46:03,543 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:46:03,545 - app.main - INFO - GET /api/health - 200 - 10.94ms
2026-01-05 01:46:03,640 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:46:03,672 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:46:03,696 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:46:03,710 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:46:03,725 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:46:03,728 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:46:03,733 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:46:03,736 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:46:03,738 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:46:03,741 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:46:03,768 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:46:03,773 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:46:03,796 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:46:03,811 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:46:03,823 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:46:03,824 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:46:03,826 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:46:03,827 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:46:03,827 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:46:03,828 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:46:03,829 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:46:03,831 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:46:03,851 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:46:03,934 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 345.88ms
2026-01-05 01:46:03,944 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:46:03,954 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:46:03,966 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:46:03,967 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:46:03,968 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:46:03,969 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:46:03,970 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:46:03,971 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:46:03,972 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:46:03,974 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:46:03,991 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:46:03,993 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:46:03,995 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 408.76ms
2026-01-05 01:46:03,996 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:46:04,038 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:46:04,040 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 12.00ms
2026-01-05 01:46:04,063 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 01:46:04,065 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 21.61ms
2026-01-05 01:46:04,069 - app.main - INFO - GET /api/recommendations/cross-sell/15 - 404 - 1.44ms
2026-01-05 01:47:23,377 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:47:23,379 - app.main - INFO - GET /api/health - 200 - 13.83ms
2026-01-05 01:47:23,391 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:47:23,393 - app.main - INFO - GET /api/health - 200 - 10.76ms
2026-01-05 01:47:23,411 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:47:23,413 - app.main - INFO - GET /api/health - 200 - 13.36ms
2026-01-05 01:47:23,427 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:47:23,430 - app.main - INFO - GET /api/health - 200 - 13.73ms
2026-01-05 01:47:23,457 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:47:23,466 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:47:23,479 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:47:23,480 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:47:23,481 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:47:23,482 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:47:23,483 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:47:23,483 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:47:23,485 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:47:23,487 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:47:23,503 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:47:23,506 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:47:23,508 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 66.02ms
2026-01-05 01:47:23,525 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:47:23,533 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:47:23,543 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:47:23,544 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:47:23,545 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:47:23,546 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:47:23,546 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:47:23,547 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:47:23,548 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:47:23,550 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:47:23,566 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:47:23,569 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:47:23,574 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:47:23,609 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:47:23,617 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:47:23,627 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:47:23,629 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:47:23,630 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:47:23,631 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:47:23,631 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:47:23,632 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:47:23,634 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:47:23,635 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:47:23,660 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:47:23,732 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 222.38ms
2026-01-05 01:47:23,749 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:47:23,761 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:47:23,775 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:47:23,777 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:47:23,778 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:47:23,779 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:47:23,779 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:47:23,781 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:47:23,783 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:47:23,785 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:47:23,803 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:47:23,888 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:47:23,895 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:47:23,906 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:47:23,907 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:47:23,908 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:47:23,909 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:47:23,909 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:47:23,910 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:47:23,911 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:47:23,912 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:47:23,930 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:47:23,932 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:47:23,943 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:47:23,954 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:47:23,963 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:47:23,965 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:47:23,966 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:47:23,967 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:47:23,968 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:47:23,970 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:47:23,971 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:47:23,972 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:47:23,988 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:47:23,990 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:47:23,992 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 419.24ms
2026-01-05 01:47:23,993 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:47:24,012 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 439.43ms
2026-01-05 01:54:47,218 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:54:47,224 - app.main - INFO - GET /api/health - 200 - 21.26ms
2026-01-05 01:54:47,240 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:54:47,243 - app.main - INFO - GET /api/health - 200 - 15.04ms
2026-01-05 01:54:47,275 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:54:47,280 - app.main - INFO - GET /api/health - 200 - 28.03ms
2026-01-05 01:54:47,326 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:54:47,341 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:54:47,375 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:54:47,395 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:54:47,410 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:54:47,424 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:54:47,431 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:54:47,448 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:54:47,462 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:54:47,474 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:54:47,520 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:54:47,590 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:54:47,604 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 301.21ms
2026-01-05 01:54:47,609 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 01:54:47,617 - app.main - INFO - GET /api/health - 200 - 329.13ms
2026-01-05 01:54:47,695 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:54:47,729 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:54:47,747 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:54:47,749 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:54:47,751 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:54:47,752 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:54:47,753 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:54:47,755 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:54:47,757 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:54:47,760 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:54:47,785 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:54:47,977 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:54:47,990 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:54:48,004 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:54:48,006 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:54:48,008 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:54:48,009 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:54:48,010 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:54:48,012 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:54:48,015 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:54:48,018 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:54:48,046 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:54:48,049 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:54:48,053 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 436.22ms
2026-01-05 01:54:48,056 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 01:54:48,126 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:54:48,159 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:54:48,185 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:54:48,191 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:54:48,195 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:54:48,204 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:54:48,216 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:54:48,223 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:54:48,226 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:54:48,229 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:54:48,296 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:54:48,840 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:54:48,900 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:54:48,964 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:54:48,999 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:54:49,018 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:54:49,026 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:54:49,031 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:54:49,035 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:54:49,040 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:54:49,043 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:54:49,072 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:54:49,079 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 01:54:49,082 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 999.16ms
2026-01-05 01:54:49,085 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1002.06ms
2026-01-05 01:54:49,121 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 01:54:49,147 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 01:54:49,170 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 01:54:49,176 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 01:54:49,178 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 01:54:49,180 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 01:54:49,180 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 01:54:49,185 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 01:54:49,189 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 01:54:49,191 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 01:54:49,223 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 01:54:49,231 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 01:54:49,249 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:07:47,737 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:07:47,747 - app.main - INFO - GET /api/health - 200 - 70.45ms
2026-01-05 02:07:47,772 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:07:47,775 - app.main - INFO - GET /api/health - 200 - 17.59ms
2026-01-05 02:07:47,802 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:07:47,805 - app.main - INFO - GET /api/health - 200 - 18.33ms
2026-01-05 02:07:47,825 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:07:47,827 - app.main - INFO - GET /api/health - 200 - 16.88ms
2026-01-05 02:07:47,931 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:07:47,960 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:07:47,986 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:07:47,993 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:07:47,995 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:07:47,997 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:07:47,998 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:07:48,003 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:07:48,007 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:07:48,013 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:07:48,068 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:07:48,242 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:07:48,254 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:07:48,276 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:07:48,278 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:07:48,280 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:07:48,282 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:07:48,282 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:07:48,284 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:07:48,286 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:07:48,288 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:07:48,349 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:07:48,393 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:07:48,459 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:07:48,495 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:07:48,519 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:07:48,528 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:07:48,532 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:07:48,534 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:07:48,534 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:07:48,536 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:07:48,539 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:07:48,541 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:07:48,576 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:07:48,581 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:07:48,584 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 721.17ms
2026-01-05 02:07:48,588 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:07:48,635 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 768.11ms
2026-01-05 02:07:48,669 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:07:48,702 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:07:48,727 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:07:48,730 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:07:48,733 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:07:48,735 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:07:48,737 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:07:48,741 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:07:48,745 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:07:48,750 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:07:48,776 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:07:48,779 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:07:48,810 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:07:48,840 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:07:48,865 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:07:48,867 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:07:48,869 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:07:48,872 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:07:48,877 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:07:48,879 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:07:48,880 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:07:48,882 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:07:48,909 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:07:48,914 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:07:48,935 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:07:48,952 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:07:48,970 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:07:48,975 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:07:48,978 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:07:48,980 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:07:48,981 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:07:48,983 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:07:48,985 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:07:48,987 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:07:49,013 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:07:49,224 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:07:49,250 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 608.44ms
2026-01-05 02:07:49,252 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 610.62ms
2026-01-05 02:09:03,552 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:09:03,560 - app.main - INFO - GET /api/health - 200 - 33.05ms
2026-01-05 02:09:03,594 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:09:03,599 - app.main - INFO - GET /api/health - 200 - 22.91ms
2026-01-05 02:09:03,779 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:09:03,812 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:09:03,833 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:09:04,012 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:09:04,055 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:09:04,109 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:09:04,130 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:09:04,140 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:09:04,148 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:09:04,163 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:09:04,174 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:09:04,222 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:09:04,415 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 671.55ms
2026-01-05 02:09:04,416 - app.main - INFO - GET /api/health - 200 - 787.99ms
2026-01-05 02:09:04,443 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:09:04,455 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:09:04,473 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:09:04,475 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:09:04,478 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:09:04,480 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:09:04,480 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:09:04,482 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:09:04,484 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:09:04,486 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:09:04,512 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:09:04,514 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:09:04,519 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 104.14ms
2026-01-05 02:09:04,540 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:09:04,553 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:09:04,568 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:09:04,570 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:09:04,574 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:09:04,575 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:09:04,576 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:09:04,577 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:09:04,578 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:09:04,580 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:09:04,602 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:09:04,607 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:09:04,609 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:09:05,306 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:09:05,316 - app.main - INFO - GET /api/health - 200 - 887.72ms
2026-01-05 02:09:05,503 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:09:05,528 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:09:05,546 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:09:05,548 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:09:05,549 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:09:05,550 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:09:05,551 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:09:05,552 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:09:05,554 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:09:05,558 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:09:05,609 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:09:05,638 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:09:05,646 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 169.55ms
2026-01-05 02:09:05,735 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:09:05,764 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:09:05,799 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:09:05,811 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:09:05,816 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:09:05,818 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:09:05,819 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:09:05,825 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:09:05,827 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:09:05,830 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:09:05,853 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:09:05,862 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:09:05,880 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:09:05,894 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:09:05,915 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:09:05,929 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:09:05,934 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:09:05,935 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:09:05,936 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:09:05,937 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:09:05,947 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:09:05,952 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:09:05,982 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:09:06,210 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:09:06,259 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 562.64ms
2026-01-05 02:10:09,036 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 02:10:21,759 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:10:21,772 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:10:21,788 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:10:21,791 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:10:21,792 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:10:21,793 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:10:21,794 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:10:21,825 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 02:10:21,969 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 02:10:21,996 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:10:21,997 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:10:21,999 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:10:22,033 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:10:22,261 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 02:10:47,090 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 02:10:47,091 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 02:10:47,092 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 02:10:47,095 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 02:10:47,096 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:10:51,295 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 02:10:51,591 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 02:10:51,967 - app.main - INFO - ======================================================================
2026-01-05 02:10:51,967 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 02:10:51,967 - app.main - INFO - ======================================================================
2026-01-05 02:10:51,968 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 02:10:51,968 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 02:10:51,968 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:10:51,969 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 02:10:51,972 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 02:10:51,974 - app.main - INFO - ======================================================================
2026-01-05 02:11:01,386 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:11:01,397 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:11:01,414 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:11:01,416 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:11:01,418 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:11:01,419 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:11:01,419 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:11:01,434 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 02:11:01,471 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 02:11:01,485 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:11:01,487 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:11:01,490 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:11:01,510 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:11:01,630 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 02:11:11,284 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 02:11:11,285 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 02:11:11,285 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 02:11:11,292 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 02:11:11,293 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:11:14,992 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 02:11:15,236 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 02:11:15,432 - app.main - INFO - ======================================================================
2026-01-05 02:11:15,433 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 02:11:15,433 - app.main - INFO - ======================================================================
2026-01-05 02:11:15,434 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 02:11:15,434 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 02:11:15,434 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:11:15,435 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 02:11:15,435 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 02:11:15,435 - app.main - INFO - ======================================================================
2026-01-05 02:11:16,389 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:11:16,396 - app.main - INFO - GET /api/health - 200 - 925.85ms
2026-01-05 02:11:16,410 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:11:16,413 - app.main - INFO - GET /api/health - 200 - 12.91ms
2026-01-05 02:12:49,168 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:12:49,172 - app.main - INFO - GET /api/health - 200 - 23.75ms
2026-01-05 02:12:49,191 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:12:49,194 - app.main - INFO - GET /api/health - 200 - 16.13ms
2026-01-05 02:12:49,232 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:12:49,235 - app.main - INFO - GET /api/health - 200 - 26.47ms
2026-01-05 02:12:49,260 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:12:49,263 - app.main - INFO - GET /api/health - 200 - 15.06ms
2026-01-05 02:12:49,397 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:12:49,418 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:12:49,436 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:12:49,442 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:12:49,444 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:12:49,446 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:12:49,447 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:12:49,453 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:12:49,455 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:12:49,461 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:12:49,499 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:12:49,621 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:12:49,632 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 330.28ms
2026-01-05 02:12:49,675 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:12:49,685 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:12:49,708 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:12:49,711 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:12:49,713 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:12:49,714 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:12:49,715 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:12:49,716 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:12:49,717 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:12:49,719 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:12:49,745 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:12:49,748 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:12:49,763 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:12:49,780 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:12:49,802 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:12:49,807 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:12:49,809 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:12:49,810 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:12:49,810 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:12:49,811 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:12:49,813 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:12:49,815 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:12:49,840 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:12:49,992 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:12:50,458 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 1093.54ms
2026-01-05 02:12:50,477 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:12:50,514 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:12:50,542 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:12:50,544 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:12:50,547 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:12:50,551 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:12:50,556 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:12:50,560 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:12:50,564 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:12:50,568 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:12:50,594 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:12:50,797 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:12:50,815 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:12:50,833 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:12:50,835 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:12:50,837 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:12:50,838 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:12:50,841 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:12:50,843 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:12:50,845 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:12:50,848 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:12:50,887 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:12:50,899 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:12:50,922 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:12:50,940 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:12:50,956 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:12:50,959 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:12:50,961 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:12:50,962 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:12:50,966 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:12:50,969 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:12:50,972 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:12:50,978 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:12:51,000 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:12:51,003 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:12:51,005 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 1359.98ms
2026-01-05 02:12:51,008 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1362.59ms
2026-01-05 02:12:51,009 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:13:06,873 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 02:13:12,509 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:12,521 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:12,533 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:12,535 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:12,539 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:12,541 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:12,542 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:12,570 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 02:13:13,165 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 02:13:13,200 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:13,201 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:13,203 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:13,232 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:13,401 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 02:13:21,044 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:21,056 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:21,068 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:21,070 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:21,072 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:21,076 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:21,076 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:21,113 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 02:13:21,212 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 02:13:21,244 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:21,245 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:21,247 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:21,277 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:21,452 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 02:13:49,176 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 02:13:49,179 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 02:13:49,184 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 02:13:49,191 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 02:13:49,204 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:13:53,782 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 02:13:54,282 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 02:13:54,823 - app.main - INFO - ======================================================================
2026-01-05 02:13:54,827 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 02:13:54,838 - app.main - INFO - ======================================================================
2026-01-05 02:13:54,845 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 02:13:54,850 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 02:13:54,853 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:13:54,860 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 02:13:54,865 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 02:13:54,867 - app.main - INFO - ======================================================================
2026-01-05 02:13:56,312 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:56,338 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:56,379 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:56,385 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:56,395 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:56,398 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:56,400 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:56,408 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:56,414 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:56,419 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:56,456 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:56,686 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:56,727 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:56,769 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:56,783 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:56,796 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:56,798 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:56,799 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:56,800 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:56,802 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:56,808 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:56,842 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:57,068 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:57,088 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:57,140 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:57,150 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:57,186 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:57,196 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:57,200 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:57,207 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:57,215 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:57,222 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:57,259 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:57,262 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:13:57,288 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:57,308 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:57,331 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:57,334 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:57,340 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:57,343 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:57,347 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:57,350 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:57,353 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:57,356 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:57,391 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:57,398 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:13:57,428 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:57,449 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:57,467 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:57,474 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:57,480 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:57,482 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:57,484 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:57,487 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:57,495 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:57,498 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:57,526 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:57,529 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:13:57,546 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:13:57,568 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:13:57,601 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:13:57,608 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:13:57,618 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:13:57,623 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:13:57,625 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:13:57,631 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:13:57,639 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:13:57,646 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:13:57,681 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:13:57,699 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:13:57,709 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 2744.33ms
2026-01-05 02:13:57,722 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 2757.43ms
2026-01-05 02:13:57,738 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 2773.49ms
2026-01-05 02:13:57,749 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 2783.38ms
2026-01-05 02:13:57,758 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:13:57,861 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:13:57,938 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:13:57,942 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:13:57,955 - app.main - INFO - GET /api/health - 200 - 2988.16ms
2026-01-05 02:13:57,962 - app.main - INFO - GET /api/health - 200 - 2995.09ms
2026-01-05 02:15:10,135 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 02:15:10,137 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 02:15:10,141 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 02:15:10,146 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 02:15:10,148 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:15:14,341 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 02:15:14,742 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 02:15:15,125 - app.main - INFO - ======================================================================
2026-01-05 02:15:15,125 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 02:15:15,126 - app.main - INFO - ======================================================================
2026-01-05 02:15:15,127 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 02:15:15,127 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 02:15:15,127 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:15:15,128 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 02:15:15,128 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 02:15:15,129 - app.main - INFO - ======================================================================
2026-01-05 02:15:26,153 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:15:26,172 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:15:26,193 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:15:26,194 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:15:26,196 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:15:26,197 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:15:26,198 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:15:26,223 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 02:15:26,282 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 02:15:26,311 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:15:26,313 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:15:26,316 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:15:26,346 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:15:26,498 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 02:15:40,805 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 02:15:40,806 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 02:15:40,806 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 02:15:40,809 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 02:15:40,810 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:15:44,332 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 02:15:44,524 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 02:15:44,727 - app.main - INFO - ======================================================================
2026-01-05 02:15:44,728 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 02:15:44,728 - app.main - INFO - ======================================================================
2026-01-05 02:15:44,729 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 02:15:44,729 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 02:15:44,729 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 02:15:44,730 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 02:15:44,730 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 02:15:44,730 - app.main - INFO - ======================================================================
2026-01-05 02:54:22,255 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:54:22,301 - app.main - INFO - GET /api/health - 200 - 234.30ms
2026-01-05 02:54:22,378 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:54:22,382 - app.main - INFO - GET /api/health - 200 - 25.97ms
2026-01-05 02:54:22,418 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:54:22,424 - app.main - INFO - GET /api/health - 200 - 19.18ms
2026-01-05 02:54:22,448 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:54:22,455 - app.main - INFO - GET /api/health - 200 - 22.44ms
2026-01-05 02:54:22,714 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:54:22,840 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:54:22,917 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:54:22,921 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:54:22,938 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:54:22,953 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:54:22,955 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:54:22,973 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:54:22,977 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:54:22,995 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:54:23,126 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:54:23,157 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:54:23,164 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 624.28ms
2026-01-05 02:54:23,195 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:54:23,221 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:54:23,238 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:54:23,240 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:54:23,241 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:54:23,242 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:54:23,244 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:54:23,246 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:54:23,247 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:54:23,248 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:54:23,274 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:54:23,433 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 267.60ms
2026-01-05 02:54:23,471 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:54:23,487 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:54:23,502 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:54:23,504 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:54:23,505 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:54:23,506 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:54:23,507 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:54:23,508 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:54:23,512 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:54:23,515 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:54:23,544 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:54:23,550 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:54:23,568 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:54:23,580 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:54:23,594 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:54:23,596 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:54:23,597 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:54:23,599 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:54:23,599 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:54:23,600 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:54:23,601 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:54:23,603 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:54:23,626 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:54:23,631 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:54:23,651 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:54:23,669 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:54:23,684 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:54:23,689 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:54:23,698 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:54:23,701 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:54:23,704 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:54:23,706 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:54:23,707 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:54:23,714 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:54:23,739 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:54:23,899 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:54:23,914 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:54:23,929 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:54:23,931 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:54:23,933 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:54:23,934 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:54:23,935 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:54:23,936 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:54:23,937 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:54:23,939 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:54:23,970 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:54:23,974 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:54:23,981 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:54:24,094 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 921.75ms
2026-01-05 02:54:24,110 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 937.91ms
2026-01-05 02:54:24,202 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:55:07,966 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:55:07,981 - app.main - INFO - GET /api/health - 200 - 56.76ms
2026-01-05 02:55:08,017 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:55:08,023 - app.main - INFO - GET /api/health - 200 - 25.85ms
2026-01-05 02:55:08,052 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:55:08,061 - app.main - INFO - GET /api/health - 200 - 27.33ms
2026-01-05 02:55:08,123 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:55:08,143 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:55:08,165 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:55:08,167 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:55:08,172 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:55:08,176 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:55:08,178 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:55:08,181 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:55:08,182 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:55:08,193 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:55:08,220 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:55:08,224 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:55:08,240 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:55:08,256 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:55:08,282 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:55:08,285 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:55:08,287 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:55:08,288 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:55:08,289 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:55:08,290 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:55:08,292 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:55:08,295 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:55:08,325 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:55:08,330 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:55:08,347 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:55:08,359 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:55:08,382 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:55:08,384 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:55:08,385 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:55:08,387 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:55:08,388 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:55:08,390 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:55:08,392 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:55:08,395 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:55:08,418 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:55:08,584 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 490.37ms
2026-01-05 02:55:08,586 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:55:08,610 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 515.88ms
2026-01-05 02:55:08,624 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:55:08,637 - app.main - INFO - GET /api/health - 200 - 546.12ms
2026-01-05 02:55:08,807 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:55:08,832 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:55:08,855 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:55:08,861 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:55:08,866 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:55:08,868 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:55:08,871 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:55:08,873 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:55:08,875 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:55:08,881 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:55:08,917 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:55:09,122 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 348.43ms
2026-01-05 02:55:09,148 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:55:09,166 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:55:09,187 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:55:09,189 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:55:09,191 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:55:09,193 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:55:09,195 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:55:09,197 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:55:09,198 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:55:09,200 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:55:09,225 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:55:09,230 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:55:09,249 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:55:09,273 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:55:09,300 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:55:09,306 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:55:09,312 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:55:09,313 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:55:09,314 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:55:09,316 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:55:09,318 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:55:09,319 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:55:09,352 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:55:09,357 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:55:09,362 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 236.45ms
2026-01-05 02:55:09,364 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:57:04,326 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:57:04,331 - app.main - INFO - GET /api/health - 200 - 18.60ms
2026-01-05 02:57:04,350 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:57:04,353 - app.main - INFO - GET /api/health - 200 - 19.27ms
2026-01-05 02:57:04,385 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:57:04,389 - app.main - INFO - GET /api/health - 200 - 14.47ms
2026-01-05 02:57:04,421 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:57:04,449 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:57:04,469 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:57:04,490 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:57:04,495 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:57:04,497 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:57:04,499 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:57:04,500 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:57:04,502 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:57:04,504 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:57:04,505 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:57:04,553 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:57:04,573 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:57:04,608 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:57:04,645 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:57:04,685 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:57:04,697 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:57:04,705 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:57:04,712 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:57:04,716 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:57:04,719 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:57:04,721 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:57:04,727 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:57:04,758 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:57:04,764 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:57:04,767 - app.main - INFO - GET /api/health - 200 - 365.08ms
2026-01-05 02:57:04,770 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:57:04,809 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 390.84ms
2026-01-05 02:57:04,870 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:57:04,891 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:57:04,917 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:57:04,921 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:57:04,930 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:57:04,933 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:57:04,935 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:57:04,940 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:57:04,944 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:57:04,953 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:57:04,986 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:57:05,185 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 762.00ms
2026-01-05 02:57:05,240 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:57:05,301 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:57:05,323 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:57:05,334 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:57:05,344 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:57:05,370 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:57:05,396 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:57:05,401 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:57:05,409 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:57:05,413 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:57:05,440 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:57:05,610 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 418.10ms
2026-01-05 02:57:05,634 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:57:05,649 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:57:05,671 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:57:05,674 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:57:05,680 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:57:05,683 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:57:05,685 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:57:05,687 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:57:05,689 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:57:05,691 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:57:05,729 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:57:05,734 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:57:05,736 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 539.65ms
2026-01-05 02:59:43,215 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:59:43,221 - app.main - INFO - GET /api/health - 200 - 186.10ms
2026-01-05 02:59:43,337 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:59:43,340 - app.main - INFO - GET /api/health - 200 - 21.81ms
2026-01-05 02:59:43,404 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:59:43,409 - app.main - INFO - GET /api/health - 200 - 19.73ms
2026-01-05 02:59:43,442 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 02:59:43,448 - app.main - INFO - GET /api/health - 200 - 31.46ms
2026-01-05 02:59:43,857 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:59:43,887 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:59:43,918 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:59:43,921 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:59:43,924 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:59:43,926 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:59:43,931 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:59:43,935 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:59:43,939 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:59:43,943 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:59:43,976 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:59:43,984 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:59:44,002 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:59:44,019 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:59:44,041 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:59:44,046 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:59:44,049 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:59:44,050 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:59:44,051 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:59:44,052 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:59:44,054 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:59:44,056 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:59:44,086 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:59:44,090 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:59:44,096 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:59:44,122 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 297.81ms
2026-01-05 02:59:44,154 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:59:44,174 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:59:44,196 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:59:44,198 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:59:44,200 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:59:44,202 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:59:44,202 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:59:44,204 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:59:44,205 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:59:44,208 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:59:44,233 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:59:44,236 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 02:59:44,256 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:59:44,274 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:59:44,299 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:59:44,302 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:59:44,304 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:59:44,305 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:59:44,306 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:59:44,307 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:59:44,312 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:59:44,315 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:59:44,342 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:59:44,348 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 02:59:44,352 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 517.90ms
2026-01-05 02:59:44,355 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 02:59:44,440 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:59:44,469 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:59:44,506 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:59:44,518 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:59:44,526 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:59:44,532 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:59:44,536 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:59:44,540 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:59:44,545 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:59:44,551 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:59:44,579 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:59:44,753 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 02:59:44,767 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 02:59:44,783 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 02:59:44,784 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 02:59:44,787 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 02:59:44,788 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 02:59:44,789 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 02:59:44,790 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 02:59:44,792 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 02:59:44,796 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 02:59:44,825 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 02:59:44,967 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 871.38ms
2026-01-05 02:59:44,973 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 877.42ms
2026-01-05 02:59:45,089 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 02:59:45,098 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 54.05ms
2026-01-05 02:59:45,135 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 02:59:45,142 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 34.10ms
2026-01-05 02:59:45,176 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 02:59:45,186 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 30.24ms
2026-01-05 02:59:45,243 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 02:59:45,248 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 26.71ms
2026-01-05 02:59:45,275 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 02:59:45,284 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 26.85ms
2026-01-05 02:59:45,347 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 02:59:45,351 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 49.13ms
2026-01-05 16:30:19,927 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:30:19,964 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:30:19,993 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:30:20,017 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:30:20,036 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:30:20,051 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:30:20,052 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:30:20,072 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 16:30:20,460 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 16:30:20,496 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:30:20,521 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:30:20,538 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:30:20,603 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:30:20,722 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
2026-01-05 16:31:22,929 - app.services.search_service - INFO - [OK] Sentence Transformers disponible
2026-01-05 16:31:22,929 - app.services.search_service - INFO - [OK] FAISS disponible
2026-01-05 16:31:22,931 - app.services.search_service - INFO - [LOADING] Chargement du modele sentence-transformers/all-MiniLM-L6-v2...
2026-01-05 16:31:22,935 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-05 16:31:22,935 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 16:31:37,819 - app.services.search_service - INFO - [OK] Modele d'embeddings charge
2026-01-05 16:31:38,150 - app.services.llm_service - INFO - [OK] Transformers disponible
2026-01-05 16:31:38,569 - app.main - INFO - ======================================================================
2026-01-05 16:31:38,571 - app.main - INFO - [START] DEMARRAGE SERVICE PYTHON ML & ETL
2026-01-05 16:31:38,572 - app.main - INFO - ======================================================================
2026-01-05 16:31:38,574 - app.main - INFO - [DOCS] Documentation: http://localhost:5000/docs
2026-01-05 16:31:38,575 - app.main - INFO - [JAVA] Backend Java: http://localhost:8080/api
2026-01-05 16:31:38,576 - app.main - INFO - [EMB] Embeddings: sentence-transformers/all-MiniLM-L6-v2
2026-01-05 16:31:38,576 - app.main - INFO - [LLM] Ollama: mistral
2026-01-05 16:31:38,577 - app.main - INFO - [LLM] HuggingFace: TinyLlama/TinyLlama-1.1B-Chat-v1.0
2026-01-05 16:31:38,578 - app.main - INFO - ======================================================================
2026-01-05 16:32:59,405 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:32:59,411 - app.main - INFO - GET /api/health - 200 - 772.72ms
2026-01-05 16:32:59,474 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:32:59,476 - app.main - INFO - GET /api/health - 200 - 17.17ms
2026-01-05 16:32:59,505 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:32:59,507 - app.main - INFO - GET /api/health - 200 - 17.30ms
2026-01-05 16:32:59,528 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:32:59,533 - app.main - INFO - GET /api/health - 200 - 16.59ms
2026-01-05 16:32:59,594 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:32:59,612 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:32:59,628 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:32:59,633 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:32:59,635 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:32:59,636 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:32:59,637 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:32:59,639 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:32:59,640 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:32:59,642 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:32:59,663 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:32:59,721 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 16:32:59,726 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 155.12ms
2026-01-05 16:32:59,752 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:32:59,767 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:32:59,777 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:32:59,779 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:32:59,784 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:32:59,785 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:32:59,786 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:32:59,787 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:32:59,788 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:32:59,790 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:32:59,822 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:32:59,825 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 16:32:59,833 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 108.69ms
2026-01-05 16:32:59,860 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:32:59,879 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:32:59,895 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:32:59,900 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:32:59,902 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:32:59,905 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:32:59,905 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:32:59,907 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:32:59,908 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:32:59,910 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:32:59,936 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:33:00,089 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:33:00,107 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:33:00,121 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:33:00,123 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:33:00,124 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:33:00,126 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:33:00,126 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:33:00,128 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:33:00,129 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:33:00,136 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:33:00,159 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:33:00,307 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:33:00,319 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:33:00,328 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:33:00,329 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:33:00,334 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:33:00,335 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:33:00,335 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:33:00,336 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:33:00,337 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:33:00,339 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:33:00,360 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:33:00,362 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 16:33:00,381 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:33:00,393 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:33:00,410 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:33:00,412 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:33:00,417 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:33:00,418 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:33:00,419 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:33:00,421 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:33:00,423 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:33:00,425 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:33:00,445 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:33:00,452 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 16:33:00,456 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 629.44ms
2026-01-05 16:33:00,457 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 630.42ms
2026-01-05 16:33:00,458 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 16:33:00,907 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 16:33:00,974 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:33:00,976 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 14.28ms
2026-01-05 16:33:00,998 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:33:01,003 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 15.88ms
2026-01-05 16:33:01,025 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:33:01,027 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 16.92ms
2026-01-05 16:33:01,059 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:33:01,062 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 16.50ms
2026-01-05 16:33:01,086 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:33:01,092 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 21.59ms
2026-01-05 16:33:01,114 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:33:01,128 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 27.94ms
2026-01-05 16:50:02,026 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:50:02,041 - app.main - INFO - GET /api/health - 200 - 85.99ms
2026-01-05 16:50:02,109 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:50:02,115 - app.main - INFO - GET /api/health - 200 - 19.40ms
2026-01-05 16:50:02,157 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:50:02,161 - app.main - INFO - GET /api/health - 200 - 25.68ms
2026-01-05 16:50:02,190 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 16:50:02,194 - app.main - INFO - GET /api/health - 200 - 21.91ms
2026-01-05 16:50:02,298 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:50:02,334 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:50:02,374 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:50:02,380 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:50:02,384 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:50:02,386 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:50:02,386 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:50:02,395 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:50:02,398 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:50:02,407 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:50:02,482 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:50:02,590 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 382.79ms
2026-01-05 16:50:02,610 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:50:02,622 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:50:02,637 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:50:02,639 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:50:02,641 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:50:02,642 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:50:02,643 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:50:02,644 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:50:02,646 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:50:02,648 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:50:02,673 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:50:02,676 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 16:50:02,684 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 467.78ms
2026-01-05 16:50:02,705 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:50:02,718 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:50:02,729 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:50:02,731 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:50:02,734 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:50:02,735 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:50:02,736 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:50:02,737 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:50:02,738 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:50:02,740 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:50:02,764 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:50:02,768 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 16:50:02,772 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 16:50:02,821 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:50:02,835 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:50:02,849 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:50:02,851 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:50:02,853 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:50:02,854 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:50:02,855 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:50:02,856 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:50:02,857 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:50:02,858 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:50:02,884 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:50:02,886 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 16:50:02,901 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:50:02,912 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:50:02,926 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:50:02,931 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:50:02,933 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:50:02,935 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:50:02,936 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:50:02,938 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:50:02,939 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:50:02,940 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:50:02,961 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:50:03,075 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 16:50:03,092 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 16:50:03,108 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 16:50:03,110 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 16:50:03,112 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 16:50:03,114 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 16:50:03,115 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 16:50:03,117 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 16:50:03,119 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 16:50:03,121 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 16:50:03,142 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 16:50:03,146 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 16:50:03,151 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 464.57ms
2026-01-05 16:50:03,152 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 466.03ms
2026-01-05 16:50:03,154 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 16:50:03,205 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:50:03,208 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 19.99ms
2026-01-05 16:50:03,230 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:50:03,234 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 15.47ms
2026-01-05 16:50:03,252 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:50:03,254 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 14.82ms
2026-01-05 16:50:03,281 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:50:03,285 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 17.05ms
2026-01-05 16:50:03,306 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:50:03,310 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 20.54ms
2026-01-05 16:50:03,342 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 16:50:03,344 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 24.62ms
2026-01-05 17:16:04,556 - app.main - INFO - POST /api/etl/validate - 200 - 333.93ms
2026-01-05 17:16:09,654 - app.main - INFO - GET /api/etl/jobs - 200 - 5.69ms
2026-01-05 17:24:21,517 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:21,601 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:21,664 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:21,716 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:21,733 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:21,746 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:21,752 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:21,803 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:21,838 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:21,876 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,145 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,188 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,251 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,265 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,294 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,296 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,298 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,299 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,299 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,300 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,301 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,303 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,349 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,352 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,366 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,381 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,394 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,396 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,399 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,400 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,400 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,402 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,403 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,404 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,428 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,432 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,447 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,459 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,473 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,477 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,479 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,481 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,482 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,484 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,485 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,486 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,513 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,516 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,518 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1187.84ms
2026-01-05 17:24:22,520 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1187.55ms
2026-01-05 17:24:22,522 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1188.81ms
2026-01-05 17:24:22,523 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1189.41ms
2026-01-05 17:24:22,537 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,551 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,563 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,565 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,566 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,567 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,567 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,568 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,570 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,571 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,595 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,598 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,617 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,630 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,640 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,641 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,644 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,646 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,646 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,647 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,648 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,650 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,672 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,679 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,684 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1333.29ms
2026-01-05 17:24:22,687 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 1335.94ms
2026-01-05 17:24:22,749 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,764 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,782 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,784 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,786 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,788 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,789 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,790 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,796 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,802 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,845 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,850 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,870 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,885 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:22,901 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:22,903 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:22,905 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:22,906 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:22,906 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:22,907 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:22,911 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:22,913 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:22,940 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:22,943 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:22,967 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:22,986 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:23,007 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:23,008 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:23,012 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:23,016 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:23,017 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:23,018 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:23,019 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:23,021 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:23,051 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:23,054 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:23,057 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 342.26ms
2026-01-05 17:24:23,068 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 351.88ms
2026-01-05 17:24:23,071 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 354.60ms
2026-01-05 17:24:23,105 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:23,123 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:23,150 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:23,152 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:23,154 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:23,155 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:23,156 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:23,157 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:23,158 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:23,162 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:23,190 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:23,192 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:23,197 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 129.15ms
2026-01-05 17:24:28,316 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:28,329 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:28,340 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:28,342 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:28,345 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:28,347 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:28,348 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:28,349 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:28,350 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:28,351 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:28,369 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:28,372 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:28,376 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 78.75ms
2026-01-05 17:24:28,387 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:28,398 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:28,407 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:28,411 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:28,413 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:28,414 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:28,414 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:28,415 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:28,417 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:28,418 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:28,435 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:28,437 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:28,451 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:28,460 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:28,471 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:28,473 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:28,474 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:28,475 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:28,476 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:28,478 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:28,480 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:28,481 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:28,501 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:28,503 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:28,505 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 206.30ms
2026-01-05 17:24:28,507 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 207.53ms
2026-01-05 17:24:28,522 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:28,536 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:28,552 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:28,555 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:28,556 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:28,557 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:28,557 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:28,562 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:28,566 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:28,568 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:28,590 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:28,592 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:28,616 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:24:28,632 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:24:28,650 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:24:28,651 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:24:28,653 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:24:28,654 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:24:28,654 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:24:28,655 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:24:28,656 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:24:28,657 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:24:28,683 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:24:28,685 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:24:28,687 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 386.24ms
2026-01-05 17:24:28,689 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 314.29ms
2026-01-05 17:25:58,562 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 17:25:58,570 - app.main - INFO - GET /api/health - 200 - 100.66ms
2026-01-05 17:25:58,587 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 17:25:58,588 - app.main - INFO - GET /api/health - 200 - 13.23ms
2026-01-05 17:25:58,611 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 17:25:58,616 - app.main - INFO - GET /api/health - 200 - 15.74ms
2026-01-05 17:25:58,641 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1 "HTTP/1.1 500 "
2026-01-05 17:25:58,663 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:25:58,681 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:25:58,699 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:25:58,701 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:25:58,702 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:25:58,703 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:25:58,704 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:25:58,705 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:25:58,707 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:25:58,711 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:25:58,739 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:25:58,748 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 17:25:58,768 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:25:58,783 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:25:58,800 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:25:58,801 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:25:58,803 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:25:58,804 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:25:58,804 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:25:58,806 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:25:58,807 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:25:58,810 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:25:58,834 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:25:58,989 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 17:25:59,032 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 394.18ms
2026-01-05 17:25:59,054 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:25:59,070 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:25:59,086 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:25:59,087 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:25:59,088 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:25:59,089 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:25:59,089 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:25:59,090 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:25:59,091 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:25:59,093 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:25:59,121 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:25:59,123 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:25:59,124 - app.main - INFO - GET /api/health - 200 - 504.59ms
2026-01-05 17:25:59,128 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 488.34ms
2026-01-05 17:25:59,171 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 17:25:59,175 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 22.04ms
2026-01-05 17:25:59,189 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:25:59,201 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:25:59,211 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:25:59,214 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:25:59,215 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:25:59,216 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:25:59,217 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:25:59,217 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:25:59,218 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:25:59,220 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:25:59,239 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:25:59,242 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction demande: X has 3 features, but GradientBoostingRegressor is expecting 4 features as input.
2026-01-05 17:25:59,249 - app.main - INFO - POST /api/ml/v2/predict/demand - 200 - 74.70ms
2026-01-05 17:25:59,265 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:25:59,273 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:25:59,286 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:25:59,287 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:25:59,288 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:25:59,289 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:25:59,289 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:25:59,290 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:25:59,291 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:25:59,297 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:25:59,324 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:25:59,331 - app.services.ml_service_v2 - ERROR - Erreur prÃ©diction bestseller: X has 3 features, but RandomForestClassifier is expecting 4 features as input.
2026-01-05 17:25:59,345 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:25:59,355 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:25:59,368 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:25:59,370 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:25:59,371 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:25:59,372 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:25:59,372 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:25:59,373 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:25:59,374 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:25:59,376 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:25:59,398 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:25:59,483 - app.main - ERROR - Erreur interne: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
Traceback (most recent call last):
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\khalid\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\main.py", line 107, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\.venv\Lib\site-packages\fastapi\routing.py", line 215, in serialize_response
    raise ResponseValidationError(
    ...<3 lines>...
    )
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'string_type', 'loc': ('response', 'factors', 0), 'msg': 'Input should be a valid string', 'input': {'factor': 'reviews', 'impact': 'negative', 'value': 0, 'message': "ðŸ“\x9d Peu d'avis"}}
  {'type': 'string_type', 'loc': ('response', 'factors', 1), 'msg': 'Input should be a valid string', 'input': {'factor': 'rank', 'impact': 'negative', 'value': 99999, 'message': 'ðŸ“Š Classement Ã\xa0 amÃ©liorer'}}

  File "C:\Users\khalid\IdeaProjects\ProjetJEE-version2-improve-analytics-pages\ProjetJEE-version2-improve-analytics-pages\python-service-final\app\api\ml_v2.py", line 177, in predict_bestseller
    POST /api/ml/v2/predict/bestseller
2026-01-05 17:25:59,502 - app.main - INFO - POST /api/ml/v2/predict/price - 200 - 253.11ms
2026-01-05 17:25:59,521 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 17:25:59,523 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 272.94ms
2026-01-05 17:25:59,538 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 17:25:59,540 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 11.89ms
2026-01-05 17:25:59,564 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 17:25:59,567 - app.main - INFO - GET /api/recommendations/similar/15 - 200 - 14.54ms
2026-01-05 17:25:59,586 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 17:25:59,588 - app.main - INFO - GET /api/recommendations/upsell/15 - 200 - 17.80ms
2026-01-05 17:25:59,607 - httpx - INFO - HTTP Request: GET http://localhost:8080/api/api/products?page=0&size=1000 "HTTP/1.1 500 "
2026-01-05 17:25:59,612 - app.main - INFO - GET /api/recommendations/crosssell/15 - 200 - 18.16ms
2026-01-05 17:52:09,609 - app.main - INFO - [STOP] ARRET DU SERVICE
2026-01-05 17:52:31,130 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de prix charge©
2026-01-05 17:52:31,151 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le de demande charge©
2026-01-05 17:52:31,177 - app.services.ml_service_v2 - INFO - œ… ModÃ¨le bestseller charge©
2026-01-05 17:52:31,179 - app.services.ml_service_v2 - INFO - œ… Scaler charge©
2026-01-05 17:52:31,181 - app.services.ml_service_v2 - INFO - œ… Label encoders charge©s
2026-01-05 17:52:31,185 - app.services.ml_service_v2 - INFO - œ… Feature columns charge©es
2026-01-05 17:52:31,186 - app.services.ml_service_v2 - INFO - ðŸ“Š ModÃ¨les ML charge©s depuis data\models
2026-01-05 17:52:31,220 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-05 17:52:31,383 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-05 17:52:31,408 - app.services.ml_service_v2 - INFO - œ… Index FAISS charge©
2026-01-05 17:52:31,412 - app.services.ml_service_v2 - INFO - œ… 513 product IDs charge©s
2026-01-05 17:52:31,416 - app.services.ml_service_v2 - INFO - œ… Embeddings shape: (513, 256)
2026-01-05 17:52:31,460 - app.services.ml_service_v2 - INFO - œ… 513 produits charge©s depuis data\uploads\amazon_dataset.csv
2026-01-05 17:52:31,623 - app.services.ml_service - INFO - [OK] Scikit-learn disponible
